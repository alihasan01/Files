(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1064:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(1);t.default=function(){n.Logger.initialize((e,t,o)=>console.log("Error: "+t+(o?" "+JSON.stringify(o()):"")),(e,t,o)=>console.log("Warning: "+t+(o?" "+JSON.stringify(o()):"")),(e,t,o)=>console.log("Info: "+t+(o?" "+JSON.stringify(o()):"")))}},1065:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(4),i=o(1066),s=o(51),a=o(1);t.default=async function(){const e=i.default();let t;const o=new s.UrlDiscoveryClient,l={info:{title:"demo-viewer-backend",version:"v1.0"},uriPrefix:await o.discoverUrl(new a.ActivityLoggingContext(""),"iModelJsOrchestrator.SF",102)};if(t=n.BentleyCloudRpcManager.initializeClient(l,e),n.RpcOperation.lookup(n.IModelTileRpcInterface,"getTileContent").policy.allowResponseCaching=(()=>n.RpcResponseCacheControl.None),void 0===l.uriPrefix||l.uriPrefix.includes("localhost"))for(const i of t.interfaces())n.RpcOperation.forEach(i,e=>e.policy.token=(e=>new n.IModelToken("test","test","test","test")));return t}},1066:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(4),i=o(32);t.default=function(){return[n.IModelReadRpcInterface,n.IModelTileRpcInterface,i.PresentationRpcInterface]}},1067:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0),i=o(92),s=o(74),a=o(1068);o(260),o(1084);const l=o(51),c=o(4),r={imodel:void 0,viewDefinitionId:void 0,accessToken:void 0};t.default=class App extends n.Component{constructor(e,t){super(e,t),this.state=r,this._rpcConfiguration=this.props.rpcConfig}componentDidMount(){s.Presentation.selection.selectionChange.addListener(this.onSelectionChanged),(async()=>{let e;try{const t="a79f7a54-1d31-4406-8dd8-5da694dd2c87",o="8929e28b-5292-438a-8b94-9451e6ddea63",n="93b6c5340d2cc99534afeb97d03227ce75c7734a",s=()=>fetch("https://qa-imodeldeveloperservices-eus.azurewebsites.net/api/v0/targetUser").then(e=>e.json()).catch(e=>{console.warn(e)}),a=await s(),d=l.AccessToken.fromSamlAssertion(a._samlAssertion),p=c.IModelVersion.asOfChangeSet(n);this._rpcConfiguration.applicationAuthorizationValue=d.toTokenString(),e=await i.IModelConnection.open(d,o,t,1,p),this.setState({imodel:e,accessToken:d})}catch(e){this.setState(r)}this.onIModelSelected(e)})()}componentWillUnmount(){s.Presentation.selection.selectionChange.removeListener(this.onSelectionChanged)}onSelectionChanged(e,t){const o=t.getSelection(e.imodel,e.level);o.isEmpty?console.log("========== Selection cleared =========="):(console.log("========== Selection change ==========="),0!==o.instanceKeys.size&&(console.log("ECInstances:"),o.instanceKeys.forEach((e,t)=>{console.log(`${t}: [${[...e].join(",")}]`)})),0!==o.nodeKeys.size&&(console.log("Nodes:"),o.nodeKeys.forEach(e=>console.log(JSON.stringify(e)))),console.log("======================================="))}async getFirstViewDefinitionId(e){const t=["BisCore:SpatialViewDefinition","BisCore:DrawingViewDefinition"],o=(await e.views.queryProps({})).filter(e=>-1!==t.indexOf(e.classFullName));if(0===o.length)throw new Error("No valid view definitions in imodel");return o[0].id}async onIModelSelected(e){if(e)try{const t=e?await this.getFirstViewDefinitionId(e):void 0;this.setState({viewDefinitionId:t})}catch(t){e.close(this.state.accessToken),this.setState(r)}else this.setState(r)}renderIModelComponents(e,t){return n.createElement("div",{className:"Content"},n.createElement("div",{className:"top-left"},n.createElement(a.default,{imodel:e,rulesetId:"Default",viewDefinitionId:t})))}render(){let e;return this.state.imodel&&this.state.viewDefinitionId&&(e=this.renderIModelComponents(this.state.imodel,this.state.viewDefinitionId)),n.createElement("div",{className:"App"},e)}}},1068:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0),i=o(88),s=o(1069),a=o(1082),l=o(1083),c=s.viewWithUnifiedSelection(i.ViewportComponent);t.default=class SimpleViewportComponent extends n.Component{render(){return n.createElement("div",null,n.createElement(c,{imodel:this.props.imodel,rulesetId:this.props.rulesetId,viewDefinitionId:this.props.viewDefinitionId}),n.createElement(a.default,null),n.createElement(l.default,null))}}},1082:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0),i=o(92);o(515);const s=()=>{const e=document.getElementsByClassName("toolbar")[0].getElementsByClassName("toolbar-button");for(let t=0;t<e.length;++t)e[t].classList.remove("active-button")},a=e=>{s(),"DIV"!==e.parentElement.tagName?e.parentElement.classList.add("active-button"):e.classList.add("active-button"),c()},l=()=>{const e=document.getElementsByClassName("active-bar");for(;e[0];)e[0].parentNode.removeChild(e[0])},c=()=>{l();const e=document.getElementsByClassName("toolbar")[0].getElementsByClassName("active-button")[0],t=document.createElement("div");t.className="active-bar",e.appendChild(t)},r=e=>{i.IModelApp.tools.run(i.ZoomViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},d=e=>{i.IModelApp.tools.run(i.PanViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},p=e=>{i.IModelApp.tools.run(i.RotateViewTool.toolId,i.IModelApp.viewManager.selectedView),a(e.target)},u=()=>{s(),l(),i.IModelApp.tools.run(i.FitViewTool.toolId,i.IModelApp.viewManager.selectedView)},m=()=>{window.open(".")};t.default=(()=>{window.oncontextmenu=(()=>{s(),l()}),i.IModelApp.tools.unRegister("Select"),i.IModelApp.accuSnap.onNoMotion=(()=>{});const e=[];return window.frameElement&&e.push(n.createElement("a",{key:5,onClick:m,className:"toolbar-button a-full-screen"},n.createElement("span",{className:"icon icon-window-full-screen"}))),e.push(n.createElement("a",{key:1,onClick:u,className:"toolbar-button"},n.createElement("span",{className:"icon icon-fit-to-view"}))),e.push(n.createElement("a",{key:2,onClick:e=>r(e),className:"toolbar-button"},n.createElement("span",{className:"icon icon-zoom"}))),e.push(n.createElement("a",{key:3,onClick:e=>d(e),className:"toolbar-button"},n.createElement("span",{className:"icon icon-hand-2"}))),e.push(n.createElement("a",{key:4,onClick:e=>p(e),className:"toolbar-button"},n.createElement("span",{className:"icon icon-gyroscope"}))),n.createElement("div",{className:"toolbar"},e)})},1083:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0);o(515);t.default=(()=>{return n.createElement("img",{className:"imjs-watermark",src:"./assets/watermark-01.svg"})})},1084:function(e,t,o){},1085:function(e,t,o){},515:function(e,t,o){},521:function(e,t,o){o(522),e.exports=o(526)},526:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(0),i=o(57),s=o(531),a=o(4),l=o(1067);o(1085),s.SimpleViewerApp.startup();s.SimpleViewerApp.viewManager.onViewOpen.addListener(async e=>{if(!e.view.is3d())return;e.view.viewFlags.renderMode=6;const t=a.ColorDef.from(166,221,255);e.view.displayStyle.backgroundColor.setFrom(t),e.view.viewFlags.constructions=!1,e.resetUndo();const o=await e.iModel.executeQuery("SELECT ECInstanceId as id, CodeValue as code, UserLabel as label FROM BisCore.SpatialCategory");for(let n=0;n<o.length;++n)"S-SLAB-CONC"===(o[n].label?o[n].label:o[n].code)&&e.view.changeCategoryDisplay(o[n].id,!1)}),s.SimpleViewerApp.ready.then(e=>{i.render(n.createElement(l.default,{rpcConfig:e}),document.getElementById("root"))})},531:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(92),i=o(74),s=o(26),a=o(88),l=o(1064),c=o(1065);l.default();t.SimpleViewerApp=class SimpleViewerApp extends n.IModelApp{static get ready(){return this._isReady}static onStartup(){const e=new Array;e.push(n.IModelApp.i18n.registerNamespace("SimpleViewer").readFinished),e.push(s.UiCore.initialize(this.i18n)),e.push(a.UiComponents.initialize(this.i18n)),i.Presentation.initialize({activeLocale:n.IModelApp.i18n.languageList()[0]}),this._isReady=Promise.all(e).then(async()=>c.default())}}},585:function(e,t){},587:function(e,t){}},[[521,1,2]]]);
//# sourceMappingURL=main.08fe73e2.chunk.js.map